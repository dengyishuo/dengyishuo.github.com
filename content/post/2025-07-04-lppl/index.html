---
title: 基于 LPPL 模型的纳斯达克指数泡沫检测与预测分析
author: MatrixSpk
date: '2025-07-04'
slug: lppl
categories:
  - quant
tags:
  - NASDAQ
  - LPPL
  - 泡沫
---



<div id="前言" class="section level1">
<h1>前言</h1>
<p>本文运用 Log-Periodic Power Law (LPPL) 模型对纳斯达克指数进行分析，旨在识别市场中的泡沫特征并预测潜在的趋势转折点。LPPL 模型结合了幂律和对数周期振荡，能够捕捉金融市场中的非线性特征和临界现象。通过 R 语言实现模型拟合与参数估计，我们对纳斯达克指数在不同历史时期的泡沫形成与破裂过程进行了实证研究，并验证了模型在市场极端波动情况下的应用价值。</p>
</div>
<div id="lppl-模型理论基础" class="section level1">
<h1>LPPL 模型理论基础</h1>
<p>LPPL 模型由 Didier Sornette 提出，用于描述金融市场中的泡沫与崩溃现象。其数学表达式为：</p>
<p><span class="math display">\[
\ln P(t) = A + B(t_c - t)^\beta + C(t_c - t)^\beta \cos\left[\omega \ln(t_c - t) + \phi\right]
\]</span></p>
<p>其中：</p>
<ul>
<li><span class="math inline">\(P(t)\)</span> 是资产价格</li>
<li><span class="math inline">\(t_c\)</span> 是临界时间点（泡沫破裂的理论时间）</li>
<li><span class="math inline">\(\beta\)</span> 是幂律指数（0 &lt; β &lt; 1）</li>
<li><span class="math inline">\(\omega\)</span> 是振荡频率</li>
<li><span class="math inline">\(\phi\)</span> 是相位角</li>
<li><span class="math inline">\(A, B, C\)</span> 是常数参数</li>
</ul>
<p>模型核心思想是，在泡沫形成过程中，价格会呈现加速上涨（或下跌）趋势，同时伴随对数周期性的振荡，反映市场参与者的从众心理和正反馈机制。</p>
</div>
<div id="r-语言实现-lppl-模型分析" class="section level1">
<h1>R 语言实现 LPPL 模型分析</h1>
<p>下面是使用 R 语言实现 LPPL 模型分析纳斯达克指数的完整代码：</p>
<pre class="r"><code># 加载必要的包
library(quantmod)</code></pre>
<pre><code>## Loading required package: xts</code></pre>
<pre><code>## Loading required package: zoo</code></pre>
<pre><code>## 
## Attaching package: &#39;zoo&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     as.Date, as.Date.numeric</code></pre>
<pre><code>## Loading required package: TTR</code></pre>
<pre><code>## Registered S3 method overwritten by &#39;quantmod&#39;:
##   method            from
##   as.zoo.data.frame zoo</code></pre>
<pre class="r"><code>library(DEoptim)</code></pre>
<pre><code>## Loading required package: parallel</code></pre>
<pre><code>## 
## DEoptim package
## Differential Evolution algorithm in R
## Authors: D. Ardia, K. Mullen, B. Peterson and J. Ulrich</code></pre>
<pre class="r"><code>library(ggplot2)
library(reshape2)

# 获取纳斯达克指数数据
getSymbols(&quot;^IXIC&quot;, from = &quot;2010-01-01&quot;, to = Sys.Date())</code></pre>
<pre><code>## [1] &quot;IXIC&quot;</code></pre>
<pre class="r"><code>nasdaq &lt;- IXIC$IXIC.Close
names(nasdaq) &lt;- &quot;Close&quot;

# 数据预处理
prices &lt;- as.numeric(nasdaq)
dates &lt;- index(nasdaq)
t &lt;- seq_along(prices)

# LPPL模型函数（优化数值稳定性）
lppl &lt;- function(t, tc, beta, omega, phi, A, B, C) {
  safe_diff &lt;- pmax(tc - t, 1e-10)
  power_term &lt;- safe_diff^beta
  cos_term &lt;- cos(omega * log(safe_diff) + phi)
  result &lt;- A + B * power_term + C * power_term * cos_term
  result &lt;- pmax(pmin(result, 20), -20)
  return(result)
}

# 残差平方和函数
lppl_sse &lt;- function(params, t, y) {
  tc &lt;- params[1]
  beta &lt;- params[2]
  omega &lt;- params[3]
  phi &lt;- params[4]
  A &lt;- params[5]
  B &lt;- params[6]
  C &lt;- params[7]
  
  if (tc &lt;= max(t) + 1 || beta &lt;= 0 || beta &gt;= 1 || omega &lt;= 0 || A &lt; 0) {
    return(1e10)
  }
  
  y_pred &lt;- lppl(t, tc, beta, omega, phi, A, B, C)
  sum((log(y) - y_pred)^2)
}

# 定义参数优化边界
lower &lt;- c(max(t) + 5, 0.1, 2 * pi, 0, min(log(prices)), -100, -100)
upper &lt;- c(max(t) + 365, 0.9, 10 * pi, 2 * pi, max(log(prices)), 100, 100)

# 差分进化算法优化
set.seed(123)
result &lt;- DEoptim(lppl_sse, lower, upper,
                  control = list(itermax = 200, NP = 100, strategy = 2, trace = TRUE),
                  t = t, y = prices)</code></pre>
<pre><code>## Iteration: 1 bestvalit: 492018.486638 bestmemit: 3993.249449    0.558294   18.948798    5.937831    9.152387   68.908510  -38.291566
## Iteration: 2 bestvalit: 424995.915138 bestmemit: 3951.050449    0.319333   13.766252    6.139294    9.867769    5.318016   -6.565053
## Iteration: 3 bestvalit: 424995.915138 bestmemit: 3951.050449    0.319333   13.766252    6.139294    9.867769    5.318016   -6.565053
## Iteration: 4 bestvalit: 424995.915138 bestmemit: 3951.050449    0.319333   13.766252    6.139294    9.867769    5.318016   -6.565053
## Iteration: 5 bestvalit: 424995.915138 bestmemit: 3951.050449    0.319333   13.766252    6.139294    9.867769    5.318016   -6.565053
## Iteration: 6 bestvalit: 424995.915138 bestmemit: 3951.050449    0.319333   13.766252    6.139294    9.867769    5.318016   -6.565053
## Iteration: 7 bestvalit: 424995.915138 bestmemit: 3951.050449    0.319333   13.766252    6.139294    9.867769    5.318016   -6.565053
## Iteration: 8 bestvalit: 418815.735432 bestmemit: 4037.146185    0.208157   13.383897    3.684935    8.897993   23.479740  -25.166122
## Iteration: 9 bestvalit: 411995.885147 bestmemit: 3912.715757    0.179978   24.597340    5.931201    9.017487   22.796251  -23.952808
## Iteration: 10 bestvalit: 408472.262724 bestmemit: 3912.715757    0.179978   24.597340    5.071319    9.017487   22.796251  -23.952808
## Iteration: 11 bestvalit: 408472.262724 bestmemit: 3912.715757    0.179978   24.597340    5.071319    9.017487   22.796251  -23.952808
## Iteration: 12 bestvalit: 408472.262724 bestmemit: 3912.715757    0.179978   24.597340    5.071319    9.017487   22.796251  -23.952808
## Iteration: 13 bestvalit: 408472.262724 bestmemit: 3912.715757    0.179978   24.597340    5.071319    9.017487   22.796251  -23.952808
## Iteration: 14 bestvalit: 365936.137456 bestmemit: 4019.503087    0.198257   23.378641    6.139294    9.867769    5.318016   -6.565053
## Iteration: 15 bestvalit: 365936.137456 bestmemit: 4019.503087    0.198257   23.378641    6.139294    9.867769    5.318016   -6.565053
## Iteration: 16 bestvalit: 362607.820294 bestmemit: 4076.822415    0.198257   23.378641    6.139294    9.867769    5.318016   -6.565053
## Iteration: 17 bestvalit: 362607.820294 bestmemit: 4076.822415    0.198257   23.378641    6.139294    9.867769    5.318016   -6.565053
## Iteration: 18 bestvalit: 362607.820294 bestmemit: 4076.822415    0.198257   23.378641    6.139294    9.867769    5.318016   -6.565053
## Iteration: 19 bestvalit: 361212.092404 bestmemit: 4076.822415    0.198257   23.378641    6.139294    9.398086    5.318016   -6.565053
## Iteration: 20 bestvalit: 361212.092404 bestmemit: 4076.822415    0.198257   23.378641    6.139294    9.398086    5.318016   -6.565053
## Iteration: 21 bestvalit: 343128.186629 bestmemit: 4132.888200    0.189445   12.410835    6.139294    9.398086    5.318016   -6.565053
## Iteration: 22 bestvalit: 343128.186629 bestmemit: 4132.888200    0.189445   12.410835    6.139294    9.398086    5.318016   -6.565053
## Iteration: 23 bestvalit: 339886.115552 bestmemit: 4058.468159    0.189445   12.410835    6.139294    9.398086    5.318016   -6.565053
## Iteration: 24 bestvalit: 337918.949978 bestmemit: 4058.468159    0.189445   12.410835    6.139294    8.336509    5.318016   -6.565053
## Iteration: 25 bestvalit: 337918.949978 bestmemit: 4058.468159    0.189445   12.410835    6.139294    8.336509    5.318016   -6.565053
## Iteration: 26 bestvalit: 337918.949978 bestmemit: 4058.468159    0.189445   12.410835    6.139294    8.336509    5.318016   -6.565053
## Iteration: 27 bestvalit: 125691.241462 bestmemit: 3912.860926    0.100139   28.745174    0.615782    9.030763    1.336184    3.258638
## Iteration: 28 bestvalit: 125691.241462 bestmemit: 3912.860926    0.100139   28.745174    0.615782    9.030763    1.336184    3.258638
## Iteration: 29 bestvalit: 125691.241462 bestmemit: 3912.860926    0.100139   28.745174    0.615782    9.030763    1.336184    3.258638
## Iteration: 30 bestvalit: 125691.241462 bestmemit: 3912.860926    0.100139   28.745174    0.615782    9.030763    1.336184    3.258638
## Iteration: 31 bestvalit: 125691.241462 bestmemit: 3912.860926    0.100139   28.745174    0.615782    9.030763    1.336184    3.258638
## Iteration: 32 bestvalit: 125691.241462 bestmemit: 3912.860926    0.100139   28.745174    0.615782    9.030763    1.336184    3.258638
## Iteration: 33 bestvalit: 125691.241462 bestmemit: 3912.860926    0.100139   28.745174    0.615782    9.030763    1.336184    3.258638
## Iteration: 34 bestvalit: 125691.241462 bestmemit: 3912.860926    0.100139   28.745174    0.615782    9.030763    1.336184    3.258638
## Iteration: 35 bestvalit: 125691.241462 bestmemit: 3912.860926    0.100139   28.745174    0.615782    9.030763    1.336184    3.258638
## Iteration: 36 bestvalit: 125691.241462 bestmemit: 3912.860926    0.100139   28.745174    0.615782    9.030763    1.336184    3.258638
## Iteration: 37 bestvalit: 125691.241462 bestmemit: 3912.860926    0.100139   28.745174    0.615782    9.030763    1.336184    3.258638
## Iteration: 38 bestvalit: 125691.241462 bestmemit: 3912.860926    0.100139   28.745174    0.615782    9.030763    1.336184    3.258638
## Iteration: 39 bestvalit: 125691.241462 bestmemit: 3912.860926    0.100139   28.745174    0.615782    9.030763    1.336184    3.258638
## Iteration: 40 bestvalit: 125691.241462 bestmemit: 3912.860926    0.100139   28.745174    0.615782    9.030763    1.336184    3.258638
## Iteration: 41 bestvalit: 125691.241462 bestmemit: 3912.860926    0.100139   28.745174    0.615782    9.030763    1.336184    3.258638
## Iteration: 42 bestvalit: 125691.241462 bestmemit: 3912.860926    0.100139   28.745174    0.615782    9.030763    1.336184    3.258638
## Iteration: 43 bestvalit: 125691.241462 bestmemit: 3912.860926    0.100139   28.745174    0.615782    9.030763    1.336184    3.258638
## Iteration: 44 bestvalit: 125691.241462 bestmemit: 3912.860926    0.100139   28.745174    0.615782    9.030763    1.336184    3.258638
## Iteration: 45 bestvalit: 125691.241462 bestmemit: 3912.860926    0.100139   28.745174    0.615782    9.030763    1.336184    3.258638
## Iteration: 46 bestvalit: 125691.241462 bestmemit: 3912.860926    0.100139   28.745174    0.615782    9.030763    1.336184    3.258638
## Iteration: 47 bestvalit: 125691.241462 bestmemit: 3912.860926    0.100139   28.745174    0.615782    9.030763    1.336184    3.258638
## Iteration: 48 bestvalit: 112057.653995 bestmemit: 3912.860926    0.100139   15.000936    0.615782    9.030763    1.336184    3.258638
## Iteration: 49 bestvalit: 112057.653995 bestmemit: 3912.860926    0.100139   15.000936    0.615782    9.030763    1.336184    3.258638
## Iteration: 50 bestvalit: 112057.653995 bestmemit: 3912.860926    0.100139   15.000936    0.615782    9.030763    1.336184    3.258638
## Iteration: 51 bestvalit: 112057.653995 bestmemit: 3912.860926    0.100139   15.000936    0.615782    9.030763    1.336184    3.258638
## Iteration: 52 bestvalit: 112057.653995 bestmemit: 3912.860926    0.100139   15.000936    0.615782    9.030763    1.336184    3.258638
## Iteration: 53 bestvalit: 77392.790491 bestmemit: 3935.219170    0.115510   25.829063    0.851508    8.096550    1.727152    1.489749
## Iteration: 54 bestvalit: 77392.790491 bestmemit: 3935.219170    0.115510   25.829063    0.851508    8.096550    1.727152    1.489749
## Iteration: 55 bestvalit: 77392.790491 bestmemit: 3935.219170    0.115510   25.829063    0.851508    8.096550    1.727152    1.489749
## Iteration: 56 bestvalit: 77392.790491 bestmemit: 3935.219170    0.115510   25.829063    0.851508    8.096550    1.727152    1.489749
## Iteration: 57 bestvalit: 77392.790491 bestmemit: 3935.219170    0.115510   25.829063    0.851508    8.096550    1.727152    1.489749
## Iteration: 58 bestvalit: 77392.790491 bestmemit: 3935.219170    0.115510   25.829063    0.851508    8.096550    1.727152    1.489749
## Iteration: 59 bestvalit: 77392.790491 bestmemit: 3935.219170    0.115510   25.829063    0.851508    8.096550    1.727152    1.489749
## Iteration: 60 bestvalit: 60118.326721 bestmemit: 3923.500372    0.107580   19.837521    0.821941    9.325889   -1.717073    1.542788
## Iteration: 61 bestvalit: 60118.326721 bestmemit: 3923.500372    0.107580   19.837521    0.821941    9.325889   -1.717073    1.542788
## Iteration: 62 bestvalit: 49872.851389 bestmemit: 4038.725693    0.114565    8.418994    2.414101    7.759659   -1.067078   -0.221825
## Iteration: 63 bestvalit: 30215.116364 bestmemit: 4038.725693    0.114565    8.418994    2.414101    8.569238   -1.067078   -0.221825
## Iteration: 64 bestvalit: 29606.498012 bestmemit: 4038.725693    0.114565    8.418994    4.861902    8.569238   -1.067078   -0.221825
## Iteration: 65 bestvalit: 19692.718995 bestmemit: 4005.325661    0.106568   25.248014    3.696875    9.876941   -1.139935    1.062789
## Iteration: 66 bestvalit: 6294.761157 bestmemit: 3907.131404    0.101169   19.948442    2.262637    9.162065    0.157543    0.601664
## Iteration: 67 bestvalit: 6294.761157 bestmemit: 3907.131404    0.101169   19.948442    2.262637    9.162065    0.157543    0.601664
## Iteration: 68 bestvalit: 6001.820316 bestmemit: 4129.262458    0.101169   19.948442    2.262637    9.162065    0.157543    0.601664
## Iteration: 69 bestvalit: 6001.820316 bestmemit: 4129.262458    0.101169   19.948442    2.262637    9.162065    0.157543    0.601664
## Iteration: 70 bestvalit: 6001.820316 bestmemit: 4129.262458    0.101169   19.948442    2.262637    9.162065    0.157543    0.601664
## Iteration: 71 bestvalit: 6001.820316 bestmemit: 4129.262458    0.101169   19.948442    2.262637    9.162065    0.157543    0.601664
## Iteration: 72 bestvalit: 6001.820316 bestmemit: 4129.262458    0.101169   19.948442    2.262637    9.162065    0.157543    0.601664
## Iteration: 73 bestvalit: 6001.820316 bestmemit: 4129.262458    0.101169   19.948442    2.262637    9.162065    0.157543    0.601664
## Iteration: 74 bestvalit: 6001.820316 bestmemit: 4129.262458    0.101169   19.948442    2.262637    9.162065    0.157543    0.601664
## Iteration: 75 bestvalit: 6001.820316 bestmemit: 4129.262458    0.101169   19.948442    2.262637    9.162065    0.157543    0.601664
## Iteration: 76 bestvalit: 6001.820316 bestmemit: 4129.262458    0.101169   19.948442    2.262637    9.162065    0.157543    0.601664
## Iteration: 77 bestvalit: 6001.820316 bestmemit: 4129.262458    0.101169   19.948442    2.262637    9.162065    0.157543    0.601664
## Iteration: 78 bestvalit: 6001.820316 bestmemit: 4129.262458    0.101169   19.948442    2.262637    9.162065    0.157543    0.601664
## Iteration: 79 bestvalit: 6001.820316 bestmemit: 4129.262458    0.101169   19.948442    2.262637    9.162065    0.157543    0.601664
## Iteration: 80 bestvalit: 6001.820316 bestmemit: 4129.262458    0.101169   19.948442    2.262637    9.162065    0.157543    0.601664
## Iteration: 81 bestvalit: 6001.820316 bestmemit: 4129.262458    0.101169   19.948442    2.262637    9.162065    0.157543    0.601664
## Iteration: 82 bestvalit: 6001.820316 bestmemit: 4129.262458    0.101169   19.948442    2.262637    9.162065    0.157543    0.601664
## Iteration: 83 bestvalit: 6001.820316 bestmemit: 4129.262458    0.101169   19.948442    2.262637    9.162065    0.157543    0.601664
## Iteration: 84 bestvalit: 2517.648142 bestmemit: 4031.399105    0.102832   28.497838    3.510810    9.559320   -0.135742    0.060735
## Iteration: 85 bestvalit: 2517.648142 bestmemit: 4031.399105    0.102832   28.497838    3.510810    9.559320   -0.135742    0.060735
## Iteration: 86 bestvalit: 2471.645781 bestmemit: 4031.399105    0.102832   30.185824    3.510810    9.559320   -0.135742    0.060735
## Iteration: 87 bestvalit: 2471.645781 bestmemit: 4031.399105    0.102832   30.185824    3.510810    9.559320   -0.135742    0.060735
## Iteration: 88 bestvalit: 2402.153392 bestmemit: 4177.873868    0.104703   30.185824    3.510810    9.559320   -0.135742    0.060735
## Iteration: 89 bestvalit: 2160.264632 bestmemit: 3989.155960    0.100317   16.023399    3.947114    8.432240    0.315928    0.084317
## Iteration: 90 bestvalit: 2160.264632 bestmemit: 3989.155960    0.100317   16.023399    3.947114    8.432240    0.315928    0.084317
## Iteration: 91 bestvalit: 2160.264632 bestmemit: 3989.155960    0.100317   16.023399    3.947114    8.432240    0.315928    0.084317
## Iteration: 92 bestvalit: 2160.264632 bestmemit: 3989.155960    0.100317   16.023399    3.947114    8.432240    0.315928    0.084317
## Iteration: 93 bestvalit: 2160.264632 bestmemit: 3989.155960    0.100317   16.023399    3.947114    8.432240    0.315928    0.084317
## Iteration: 94 bestvalit: 2055.312881 bestmemit: 4223.427130    0.102405   18.032501    2.519387    8.561611    0.105695   -0.265492
## Iteration: 95 bestvalit: 2055.312881 bestmemit: 4223.427130    0.102405   18.032501    2.519387    8.561611    0.105695   -0.265492
## Iteration: 96 bestvalit: 2055.312881 bestmemit: 4223.427130    0.102405   18.032501    2.519387    8.561611    0.105695   -0.265492
## Iteration: 97 bestvalit: 2055.312881 bestmemit: 4223.427130    0.102405   18.032501    2.519387    8.561611    0.105695   -0.265492
## Iteration: 98 bestvalit: 2055.312881 bestmemit: 4223.427130    0.102405   18.032501    2.519387    8.561611    0.105695   -0.265492
## Iteration: 99 bestvalit: 2055.312881 bestmemit: 4223.427130    0.102405   18.032501    2.519387    8.561611    0.105695   -0.265492
## Iteration: 100 bestvalit: 2055.312881 bestmemit: 4223.427130    0.102405   18.032501    2.519387    8.561611    0.105695   -0.265492
## Iteration: 101 bestvalit: 2055.312881 bestmemit: 4223.427130    0.102405   18.032501    2.519387    8.561611    0.105695   -0.265492
## Iteration: 102 bestvalit: 2055.312881 bestmemit: 4223.427130    0.102405   18.032501    2.519387    8.561611    0.105695   -0.265492
## Iteration: 103 bestvalit: 1798.641147 bestmemit: 4223.427130    0.102405   18.032501    2.519387    8.561611    0.105695   -0.178907
## Iteration: 104 bestvalit: 1428.923362 bestmemit: 4025.681866    0.102196   16.751473    3.775927    9.745335   -0.424958   -0.056636
## Iteration: 105 bestvalit: 1288.985150 bestmemit: 3909.777863    0.100431    7.925419    1.731369    9.363040   -0.325349    0.065899
## Iteration: 106 bestvalit: 1288.985150 bestmemit: 3909.777863    0.100431    7.925419    1.731369    9.363040   -0.325349    0.065899
## Iteration: 107 bestvalit: 1288.985150 bestmemit: 3909.777863    0.100431    7.925419    1.731369    9.363040   -0.325349    0.065899
## Iteration: 108 bestvalit: 1288.985150 bestmemit: 3909.777863    0.100431    7.925419    1.731369    9.363040   -0.325349    0.065899
## Iteration: 109 bestvalit: 1288.985150 bestmemit: 3909.777863    0.100431    7.925419    1.731369    9.363040   -0.325349    0.065899
## Iteration: 110 bestvalit: 1278.808455 bestmemit: 4025.681866    0.105896   15.528814    3.775927    9.745335   -0.424958   -0.056636
## Iteration: 111 bestvalit: 1278.808455 bestmemit: 4025.681866    0.105896   15.528814    3.775927    9.745335   -0.424958   -0.056636
## Iteration: 112 bestvalit: 1278.808455 bestmemit: 4025.681866    0.105896   15.528814    3.775927    9.745335   -0.424958   -0.056636
## Iteration: 113 bestvalit: 1278.808455 bestmemit: 4025.681866    0.105896   15.528814    3.775927    9.745335   -0.424958   -0.056636
## Iteration: 114 bestvalit: 1278.808455 bestmemit: 4025.681866    0.105896   15.528814    3.775927    9.745335   -0.424958   -0.056636
## Iteration: 115 bestvalit: 1274.581661 bestmemit: 4151.175970    0.111345   16.381779    0.720561    9.791686   -0.454880    0.102251
## Iteration: 116 bestvalit: 1230.215704 bestmemit: 4038.213723    0.111345   16.381779    0.720561    9.791686   -0.454880    0.102251
## Iteration: 117 bestvalit: 1228.557917 bestmemit: 4038.213723    0.112629   16.381779    0.720561    9.791686   -0.454880    0.102251
## Iteration: 118 bestvalit: 1228.557917 bestmemit: 4038.213723    0.112629   16.381779    0.720561    9.791686   -0.454880    0.102251
## Iteration: 119 bestvalit: 1228.557917 bestmemit: 4038.213723    0.112629   16.381779    0.720561    9.791686   -0.454880    0.102251
## Iteration: 120 bestvalit: 1228.557917 bestmemit: 4038.213723    0.112629   16.381779    0.720561    9.791686   -0.454880    0.102251
## Iteration: 121 bestvalit: 1228.557917 bestmemit: 4038.213723    0.112629   16.381779    0.720561    9.791686   -0.454880    0.102251
## Iteration: 122 bestvalit: 1228.557917 bestmemit: 4038.213723    0.112629   16.381779    0.720561    9.791686   -0.454880    0.102251
## Iteration: 123 bestvalit: 1228.557917 bestmemit: 4038.213723    0.112629   16.381779    0.720561    9.791686   -0.454880    0.102251
## Iteration: 124 bestvalit: 1228.557917 bestmemit: 4038.213723    0.112629   16.381779    0.720561    9.791686   -0.454880    0.102251
## Iteration: 125 bestvalit: 1228.557917 bestmemit: 4038.213723    0.112629   16.381779    0.720561    9.791686   -0.454880    0.102251
## Iteration: 126 bestvalit: 1228.557917 bestmemit: 4038.213723    0.112629   16.381779    0.720561    9.791686   -0.454880    0.102251
## Iteration: 127 bestvalit: 1228.557917 bestmemit: 4038.213723    0.112629   16.381779    0.720561    9.791686   -0.454880    0.102251
## Iteration: 128 bestvalit: 1228.557917 bestmemit: 4038.213723    0.112629   16.381779    0.720561    9.791686   -0.454880    0.102251
## Iteration: 129 bestvalit: 1228.557917 bestmemit: 4038.213723    0.112629   16.381779    0.720561    9.791686   -0.454880    0.102251
## Iteration: 130 bestvalit: 1223.959347 bestmemit: 3905.060910    0.105440   28.070122    2.308365    9.801377   -0.510798   -0.032320
## Iteration: 131 bestvalit: 1223.959347 bestmemit: 3905.060910    0.105440   28.070122    2.308365    9.801377   -0.510798   -0.032320
## Iteration: 132 bestvalit: 1223.959347 bestmemit: 3905.060910    0.105440   28.070122    2.308365    9.801377   -0.510798   -0.032320
## Iteration: 133 bestvalit: 1223.959347 bestmemit: 3905.060910    0.105440   28.070122    2.308365    9.801377   -0.510798   -0.032320
## Iteration: 134 bestvalit: 1220.110404 bestmemit: 3905.060910    0.105440   28.070122    1.735922    9.801377   -0.510798   -0.032320
## Iteration: 135 bestvalit: 1220.110404 bestmemit: 3905.060910    0.105440   28.070122    1.735922    9.801377   -0.510798   -0.032320
## Iteration: 136 bestvalit: 1220.110404 bestmemit: 3905.060910    0.105440   28.070122    1.735922    9.801377   -0.510798   -0.032320
## Iteration: 137 bestvalit: 1220.110404 bestmemit: 3905.060910    0.105440   28.070122    1.735922    9.801377   -0.510798   -0.032320
## Iteration: 138 bestvalit: 1220.110404 bestmemit: 3905.060910    0.105440   28.070122    1.735922    9.801377   -0.510798   -0.032320
## Iteration: 139 bestvalit: 1220.110404 bestmemit: 3905.060910    0.105440   28.070122    1.735922    9.801377   -0.510798   -0.032320
## Iteration: 140 bestvalit: 1185.469636 bestmemit: 3922.430121    0.117645   10.621799    0.785478    9.799112   -0.424274   -0.125585
## Iteration: 141 bestvalit: 1185.159230 bestmemit: 4000.404580    0.107531   11.749765    1.361497    9.819991   -0.490735    0.080932
## Iteration: 142 bestvalit: 1185.159230 bestmemit: 4000.404580    0.107531   11.749765    1.361497    9.819991   -0.490735    0.080932
## Iteration: 143 bestvalit: 1148.859470 bestmemit: 3909.548830    0.100431    7.925419    1.731369    9.643550   -0.388455    0.102521
## Iteration: 144 bestvalit: 1110.947662 bestmemit: 3963.786508    0.106942    7.516616    1.468775    9.932552   -0.485463   -0.063349
## Iteration: 145 bestvalit: 1098.151150 bestmemit: 3904.752885    0.110852    7.925419    1.731369    9.643550   -0.388455    0.102521
## Iteration: 146 bestvalit: 1098.151150 bestmemit: 3904.752885    0.110852    7.925419    1.731369    9.643550   -0.388455    0.102521
## Iteration: 147 bestvalit: 1098.151150 bestmemit: 3904.752885    0.110852    7.925419    1.731369    9.643550   -0.388455    0.102521
## Iteration: 148 bestvalit: 1098.151150 bestmemit: 3904.752885    0.110852    7.925419    1.731369    9.643550   -0.388455    0.102521
## Iteration: 149 bestvalit: 1098.151150 bestmemit: 3904.752885    0.110852    7.925419    1.731369    9.643550   -0.388455    0.102521
## Iteration: 150 bestvalit: 1098.151150 bestmemit: 3904.752885    0.110852    7.925419    1.731369    9.643550   -0.388455    0.102521
## Iteration: 151 bestvalit: 1093.630259 bestmemit: 3911.121478    0.114119    7.925419    1.731369    9.643550   -0.388455    0.102521
## Iteration: 152 bestvalit: 1093.630259 bestmemit: 3911.121478    0.114119    7.925419    1.731369    9.643550   -0.388455    0.102521
## Iteration: 153 bestvalit: 1089.541709 bestmemit: 3911.121478    0.118377    7.925419    1.731369    9.643550   -0.388455    0.102521
## Iteration: 154 bestvalit: 1089.541709 bestmemit: 3911.121478    0.118377    7.925419    1.731369    9.643550   -0.388455    0.102521
## Iteration: 155 bestvalit: 1087.385395 bestmemit: 3939.512588    0.114599    8.926824    3.117277    9.923931   -0.523550   -0.061270
## Iteration: 156 bestvalit: 1087.385395 bestmemit: 3939.512588    0.114599    8.926824    3.117277    9.923931   -0.523550   -0.061270
## Iteration: 157 bestvalit: 1087.385395 bestmemit: 3939.512588    0.114599    8.926824    3.117277    9.923931   -0.523550   -0.061270
## Iteration: 158 bestvalit: 1084.211640 bestmemit: 3939.512588    0.114599    8.926824    2.729204    9.923931   -0.523550   -0.061270
## Iteration: 159 bestvalit: 1084.211640 bestmemit: 3939.512588    0.114599    8.926824    2.729204    9.923931   -0.523550   -0.061270
## Iteration: 160 bestvalit: 1084.211640 bestmemit: 3939.512588    0.114599    8.926824    2.729204    9.923931   -0.523550   -0.061270
## Iteration: 161 bestvalit: 1084.211640 bestmemit: 3939.512588    0.114599    8.926824    2.729204    9.923931   -0.523550   -0.061270
## Iteration: 162 bestvalit: 1071.252414 bestmemit: 3915.437930    0.116093    7.187009    1.458269    9.685710   -0.370961    0.098546
## Iteration: 163 bestvalit: 1071.252414 bestmemit: 3915.437930    0.116093    7.187009    1.458269    9.685710   -0.370961    0.098546
## Iteration: 164 bestvalit: 1071.252414 bestmemit: 3915.437930    0.116093    7.187009    1.458269    9.685710   -0.370961    0.098546
## Iteration: 165 bestvalit: 1071.252414 bestmemit: 3915.437930    0.116093    7.187009    1.458269    9.685710   -0.370961    0.098546
## Iteration: 166 bestvalit: 1049.494924 bestmemit: 3919.240983    0.118454    6.997928    2.989148    9.691152   -0.382966    0.123029
## Iteration: 167 bestvalit: 1049.494924 bestmemit: 3919.240983    0.118454    6.997928    2.989148    9.691152   -0.382966    0.123029
## Iteration: 168 bestvalit: 1049.494924 bestmemit: 3919.240983    0.118454    6.997928    2.989148    9.691152   -0.382966    0.123029
## Iteration: 169 bestvalit: 1049.494924 bestmemit: 3919.240983    0.118454    6.997928    2.989148    9.691152   -0.382966    0.123029
## Iteration: 170 bestvalit: 993.047065 bestmemit: 3917.977563    0.117509    7.236568    0.720561    9.895853   -0.454880    0.102251
## Iteration: 171 bestvalit: 993.047065 bestmemit: 3917.977563    0.117509    7.236568    0.720561    9.895853   -0.454880    0.102251
## Iteration: 172 bestvalit: 993.047065 bestmemit: 3917.977563    0.117509    7.236568    0.720561    9.895853   -0.454880    0.102251
## Iteration: 173 bestvalit: 993.047065 bestmemit: 3917.977563    0.117509    7.236568    0.720561    9.895853   -0.454880    0.102251
## Iteration: 174 bestvalit: 993.047065 bestmemit: 3917.977563    0.117509    7.236568    0.720561    9.895853   -0.454880    0.102251
## Iteration: 175 bestvalit: 993.047065 bestmemit: 3917.977563    0.117509    7.236568    0.720561    9.895853   -0.454880    0.102251
## Iteration: 176 bestvalit: 989.642198 bestmemit: 3954.741540    0.138756    6.605505    2.760617    9.922725   -0.447810   -0.100340
## Iteration: 177 bestvalit: 989.642198 bestmemit: 3954.741540    0.138756    6.605505    2.760617    9.922725   -0.447810   -0.100340
## Iteration: 178 bestvalit: 989.642198 bestmemit: 3954.741540    0.138756    6.605505    2.760617    9.922725   -0.447810   -0.100340
## Iteration: 179 bestvalit: 989.642198 bestmemit: 3954.741540    0.138756    6.605505    2.760617    9.922725   -0.447810   -0.100340
## Iteration: 180 bestvalit: 989.642198 bestmemit: 3954.741540    0.138756    6.605505    2.760617    9.922725   -0.447810   -0.100340
## Iteration: 181 bestvalit: 989.642198 bestmemit: 3954.741540    0.138756    6.605505    2.760617    9.922725   -0.447810   -0.100340
## Iteration: 182 bestvalit: 989.642198 bestmemit: 3954.741540    0.138756    6.605505    2.760617    9.922725   -0.447810   -0.100340
## Iteration: 183 bestvalit: 989.642198 bestmemit: 3954.741540    0.138756    6.605505    2.760617    9.922725   -0.447810   -0.100340
## Iteration: 184 bestvalit: 989.642198 bestmemit: 3954.741540    0.138756    6.605505    2.760617    9.922725   -0.447810   -0.100340
## Iteration: 185 bestvalit: 989.642198 bestmemit: 3954.741540    0.138756    6.605505    2.760617    9.922725   -0.447810   -0.100340
## Iteration: 186 bestvalit: 985.656328 bestmemit: 3917.977563    0.117509    7.236568    0.720561    9.895853   -0.474964    0.102251
## Iteration: 187 bestvalit: 985.656328 bestmemit: 3917.977563    0.117509    7.236568    0.720561    9.895853   -0.474964    0.102251
## Iteration: 188 bestvalit: 985.656328 bestmemit: 3917.977563    0.117509    7.236568    0.720561    9.895853   -0.474964    0.102251
## Iteration: 189 bestvalit: 976.853907 bestmemit: 3945.208577    0.122803    7.305644    0.428252    9.897711   -0.453381    0.115552
## Iteration: 190 bestvalit: 976.853907 bestmemit: 3945.208577    0.122803    7.305644    0.428252    9.897711   -0.453381    0.115552
## Iteration: 191 bestvalit: 960.495382 bestmemit: 3927.683224    0.129004    7.305644    0.428252    9.897711   -0.453381    0.115552
## Iteration: 192 bestvalit: 953.829350 bestmemit: 3927.683224    0.129004    7.305644    0.428252    9.906291   -0.453381    0.115552
## Iteration: 193 bestvalit: 953.829350 bestmemit: 3927.683224    0.129004    7.305644    0.428252    9.906291   -0.453381    0.115552
## Iteration: 194 bestvalit: 947.831632 bestmemit: 3920.224424    0.146975    6.811585    1.214358    9.814421   -0.377708   -0.088606
## Iteration: 195 bestvalit: 947.831632 bestmemit: 3920.224424    0.146975    6.811585    1.214358    9.814421   -0.377708   -0.088606
## Iteration: 196 bestvalit: 947.831632 bestmemit: 3920.224424    0.146975    6.811585    1.214358    9.814421   -0.377708   -0.088606
## Iteration: 197 bestvalit: 907.704083 bestmemit: 3918.615220    0.149356    6.709807    2.173205    9.926713   -0.383887   -0.130155
## Iteration: 198 bestvalit: 907.704083 bestmemit: 3918.615220    0.149356    6.709807    2.173205    9.926713   -0.383887   -0.130155
## Iteration: 199 bestvalit: 907.704083 bestmemit: 3918.615220    0.149356    6.709807    2.173205    9.926713   -0.383887   -0.130155
## Iteration: 200 bestvalit: 903.579238 bestmemit: 3915.101250    0.148218    6.709807    2.173205    9.926713   -0.383887   -0.130155</code></pre>
<pre class="r"><code>best_params &lt;- result$optim$bestmem
names(best_params) &lt;- c(&quot;tc&quot;, &quot;beta&quot;, &quot;omega&quot;, &quot;phi&quot;, &quot;A&quot;, &quot;B&quot;, &quot;C&quot;)

# 计算拟合值
fitted_values &lt;- lppl(t, best_params[&quot;tc&quot;], best_params[&quot;beta&quot;],
                      best_params[&quot;omega&quot;], best_params[&quot;phi&quot;],
                      best_params[&quot;A&quot;], best_params[&quot;B&quot;], best_params[&quot;C&quot;])
predicted_prices &lt;- exp(fitted_values)

# 预测未来120天（修正行数不一致问题）
future_t &lt;- seq(max(t), max(t) + 119)  # 改为119确保总天数120
future_fitted &lt;- sapply(future_t, function(x) {
  if (x &gt;= best_params[&quot;tc&quot;] - 1e-5) {
    best_params[&quot;A&quot;]
  } else {
    lppl(x, best_params[&quot;tc&quot;], best_params[&quot;beta&quot;],
         best_params[&quot;omega&quot;], best_params[&quot;phi&quot;],
         best_params[&quot;A&quot;], best_params[&quot;B&quot;], best_params[&quot;C&quot;])
  }
})
future_prices &lt;- exp(future_fitted)
future_dates &lt;- seq(max(dates), by = &quot;day&quot;, length.out = 120)

# 可视化结果（确保数据长度一致）
plot_data &lt;- data.frame(
  Date = c(dates, future_dates),
  Price = c(prices, future_prices),
  Type = c(rep(&quot;Actual&quot;, length(prices)), rep(&quot;Predicted&quot;, length(future_prices)))
)

p1 &lt;- ggplot(plot_data, aes(x = Date, y = Price, color = Type)) +
  geom_line() +
  geom_vline(xintercept = as.Date(dates[1]) + best_params[&quot;tc&quot;], linetype = &quot;dashed&quot;) +
  labs(title = &quot;纳斯达克指数LPPL模型拟合与预测&quot;,
       y = &quot;指数值&quot;,
       x = &quot;日期&quot;) +
  scale_color_manual(values = c(&quot;Actual&quot; = &quot;blue&quot;, &quot;Predicted&quot; = &quot;red&quot;)) +
  theme_minimal()

# 分析对数周期振荡
oscillations &lt;- best_params[&quot;C&quot;] * (best_params[&quot;tc&quot;] - t)^best_params[&quot;beta&quot;] * 
  cos(best_params[&quot;omega&quot;] * log(best_params[&quot;tc&quot;] - t) + best_params[&quot;phi&quot;])

# 可视化振荡部分
osc_data &lt;- data.frame(
  Date = dates,
  Oscillation = oscillations
)

p2 &lt;- ggplot(osc_data, aes(x = Date, y = Oscillation)) +
  geom_line(color = &quot;blue&quot;) +
  geom_hline(yintercept = 0, linetype = &quot;dashed&quot;, color = &quot;gray&quot;) +
  labs(title = &quot;LPPL模型中的对数周期振荡&quot;,
       y = &quot;振荡幅度&quot;,
       x = &quot;日期&quot;) +
  theme_minimal()

# 预测未来价格走势（增加稳定性检查）
future_t &lt;- seq(max(t), max(t) + 120, by = 1)  # 预测未来120天
future_fitted &lt;- numeric(length(future_t))

for(i in seq_along(future_t)) {
  if(future_t[i] &gt;= best_params[&quot;tc&quot;] - 1) {
    future_fitted[i] &lt;- fitted_values[length(fitted_values)]
  } else {
    future_fitted[i] &lt;- lppl(future_t[i], best_params[&quot;tc&quot;], best_params[&quot;beta&quot;], 
                             best_params[&quot;omega&quot;], best_params[&quot;phi&quot;], 
                             best_params[&quot;A&quot;], best_params[&quot;B&quot;], best_params[&quot;C&quot;])
  }
}

future_prices &lt;- exp(future_fitted)
future_prices &lt;- ifelse(is.finite(future_prices), future_prices, NA)

future_dates &lt;- seq(max(dates), by = &quot;day&quot;, length.out = length(future_t))

# 合并历史与预测数据
prediction_data &lt;- data.frame(
  Date = c(as.Date(dates), future_dates),
  Price = c(prices, future_prices),
  Type = c(rep(&quot;历史&quot;, length(prices)), rep(&quot;预测&quot;, length(future_prices)))
)

# 可视化预测结果
p3 &lt;- ggplot(prediction_data, aes(x = Date, y = Price, color = Type)) +
  geom_line() +
  geom_vline(xintercept = as.numeric(max(dates)), linetype = &quot;dashed&quot;, color = &quot;gray&quot;) +
  labs(title = &quot;纳斯达克指数LPPL模型预测&quot;,
       y = &quot;指数值&quot;,
       x = &quot;日期&quot;) +
  scale_color_manual(values = c(&quot;历史&quot; = &quot;black&quot;, &quot;预测&quot; = &quot;red&quot;)) +
  theme_minimal()

print(p1)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/LPPL-1.png" width="672" /></p>
<pre class="r"><code>print(p2)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/LPPL-2.png" width="672" /></p>
<pre class="r"><code>print(p3)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/LPPL-3.png" width="672" /></p>
<pre class="r"><code># 输出关键参数
cat(&quot;LPPL模型参数估计结果:\n&quot;)</code></pre>
<pre><code>## LPPL模型参数估计结果:</code></pre>
<pre class="r"><code>print(best_params)</code></pre>
<pre><code>##           tc         beta        omega          phi            A            B 
## 3915.1012503    0.1482183    6.7098074    2.1732048    9.9267131   -0.3838866 
##            C 
##   -0.1301545</code></pre>
<pre class="r"><code>cat(&quot;\n预测的临界时间点:&quot;, as.Date(dates[1]) + best_params[&quot;tc&quot;], &quot;\n&quot;)</code></pre>
<pre><code>## 
## 预测的临界时间点: 18528.1</code></pre>
</div>
<div id="实证分析结果" class="section level1">
<h1>实证分析结果</h1>
<p>通过对纳斯达克指数的 LPPL模型拟合，我们得到以下主要发现：</p>
<p>泡沫特征识别：模型成功捕捉到了纳斯达克指数在特定时期的加速上涨特征，以及伴随的对数周期性振荡，这与理论上的泡沫形成过程高度一致。临界时间预测：基于参数估计结果，模型预测了潜在的临界时间点 <span class="math inline">\(t_c\)</span>，这一时间点可视为泡沫可能破裂的理论时间。实际应用中，可结合其他指标（如交易量、波动率）进行综合判断。</p>
<p>振荡周期分析：对数周期振荡的频率参数 <span class="math inline">\(\omega\)</span> 反映了市场情绪的波动周期。通过分析振荡部分，我们可以识别市场参与者的从众行为强度及其变化趋势。</p>
<p>预测局限性：尽管 LPPL 模型在识别泡沫特征方面表现出色，但预测的临界时间点存在一定误差，特别是在市场环境发生重大变化时。因此，该模型更适合作为预警工具而非精确预测工具。</p>
</div>
<div id="模型改进与应用" class="section level1">
<h1>模型改进与应用</h1>
<p>建议为提高 LPPL 模型的实用性，可考虑以下改进方向：多窗口分析：采用滚动窗口方法，定期重新估计模型参数，以适应市场结构的变化。集成其他指标：结合技术指标（如 RSI、MACD）和基本面因素，构建更全面的市场预警系统。参数优化改进：探索更高效的参数优化算法，提高模型拟合的稳定性和准确性。风险管理应用：将 LPPL 模型纳入风险管理框架，当检测到显著泡沫特征时，调整仓位或实施对冲策略。</p>
</div>
<div id="结论" class="section level1">
<h1>结论</h1>
<p>LPPL 模型为分析金融市场中的泡沫现象提供了有力工具。通过对纳斯达克指数的实证分析，我们验证了模型在识别价格加速上涨和对数周期振荡方面的有效性。尽管模型预测存在一定局限性，但作为一种早期预警机制，它能够帮助投资者识别潜在的市场风险，及时调整投资策略。未来研究可进一步探索 LPPL 模型与其他市场分析方法的结合，以提高预测准确性和实用性。</p>
</div>
